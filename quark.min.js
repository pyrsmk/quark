!function(e,n){"function"==typeof define&&define.amd?define([],function(){return e.quark=n()}):"object"==typeof exports?module.exports=n():e.quark=n()}(this,function(){var e=function(n){var r;return"function"==typeof n?e._whenReady(n):r=t("string"==typeof n?/</.test(n)?e._createNodes(n)[0]:e._selectNode(n):"object"==typeof n&&null!==n&&"length"in n?n[0]:n)},n=function(r,o){var u,i,f=[];if(o="undefined"==typeof o?!1:!!o,f.quarked=!0,"string"==typeof r&&(r=/</.test(r)?e._createNodes(r):e._selectNodes(r)),"object"==typeof r&&null!==r&&"length"in r)for(u=0,i=r.length;i>u;++u)f.push(o?r[u]:t(r[u]));else"object"==typeof r&&"quarked"in r&&f.push(r);for(u in e._nodeMethods)f[u]=function(e,t){return function(){var o,u,i,f,d,c=[];for(u=0,i=e.length;i>u;++u)c.push(t.apply(e[u],arguments));if(c.length){if("object"==typeof c[0]&&null!==r&&"length"in c[0]&&c[0].length){if("quarked"in c[0][0]){for(o=[],u=0,i=c.length;i>u;++u)for(f=0,d=c[u].length;d>f;++f)o.push(c[u][f]);return n(o)}}else if("object"==typeof c[0]&&"quarked"in c[0]){for(o=[],u=0,i=c.length;i>u;++u)o.push(c[u]);return n(o)}return c[0]}return e}}(f,e._nodeMethods[u]);return f.forEach=function(e){return function(n){for(var t=-1;e[++t];)n.apply(e[t],[t]);return e}}(f),f},t=function(n){var t,r={node:null,quarked:!0};if("object"!=typeof n||null===n){var o=function(){};for(t in e._nodeMethods)r[t]=o}else if("quarked"in n)r=n;else{r.node=n;for(t in e._nodeMethods)r[t]=function(e,n){return function(){return n.apply(e,arguments)}}(r,e._nodeMethods[t])}return r};return e._whenReady=function(e){"complete"==document.readyState?e():document.addEventListener("DOMContentLoaded",e)},e._selectNode=function(e){return document.querySelector(e)},e._selectNodes=function(e){return document.querySelectorAll(e)},e._createNode=function(e){var n=document.createElement("div");return n.innerHTML=e,n.firstChild},e._createNodes=function(e){var n=document.createElement("div"),t=[];for(n.innerHTML=e,n=n.firstChild,t.push(n);n=n.nextSibling;)t.push(n);return t},e._nodeMethods={findOne:function(n){return"querySelector"in this.node?e(this.node.querySelector(n)):e()},findAll:function(e){return n("querySelectorAll"in this.node?this.node.querySelectorAll(e):[])}},{$:e,$$:n}});